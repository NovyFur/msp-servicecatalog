<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSP Service Catalog Manager</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        .header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem 0;
            margin-bottom: 2rem;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 1.875rem;
            font-weight: bold;
            color: #1e293b;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background: white;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
        }
        
        .btn:hover {
            background: #f3f4f6;
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .btn-primary:hover {
            background: #2563eb;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
            border-color: #10b981;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 2rem;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-weight: 500;
        }
        
        .tab.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card h3 {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        
        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #1e293b;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }
        
        .service-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.2s;
        }
        
        .service-card:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .service-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .service-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .service-description {
            color: #6b7280;
            font-size: 0.875rem;
        }
        
        .service-details {
            margin: 1rem 0;
        }
        
        .service-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        .service-detail .label {
            color: #6b7280;
        }
        
        .service-detail .value {
            font-weight: 600;
        }
        
        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .badge-primary {
            background: #dbeafe;
            color: #1d4ed8;
        }
        
        .badge-secondary {
            background: #f3f4f6;
            color: #374151;
        }
        
        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .service-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }
        
        .search-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-input {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            min-width: 250px;
        }
        
        .select {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background: white;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            border-radius: 0.5rem;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal h2 {
            margin-bottom: 1rem;
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.25rem;
            font-weight: 500;
            font-size: 0.875rem;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }
        
        .hidden {
            display: none;
        }
        
        .tags {
            display: flex;
            gap: 0.25rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .table th,
        .table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .table th {
            background: #f8fafc;
            font-weight: 600;
            color: #374151;
        }
        
        .table tbody tr:hover {
            background: #f8fafc;
        }
        
        .client-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .client-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .client-name {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .client-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
        }
        
        .info-label {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 0.25rem;
        }
        
        .info-value {
            font-weight: 500;
        }
        
        .chart-container {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .chart-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .report-filters {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .filter-row {
            display: flex;
            gap: 1rem;
            align-items: end;
            flex-wrap: wrap;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            
            .search-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-input {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Sample data
        const initialServices = [
            {
                id: '1',
                serviceName: 'Office 365 Setup',
                category: 'Apps & Software',
                shortDescription: 'Complete Office 365 setup and configuration',
                description: 'Microsoft Office 365 setup including user accounts, email configuration, and basic training.',
                pricing: { type: 'fixed', amount: 150, currency: 'USD', period: 'one-time', displayText: '$150 one-time' },
                serviceLevel: { responseTime: '4 hours', resolutionTime: '24 hours', availability: '9 AM - 5 PM', emergencySupport: false },
                status: 'active',
                featured: true,
                tags: ['office', 'email', 'productivity']
            },
            {
                id: '2',
                serviceName: 'Network Monitoring',
                category: 'Monitoring',
                shortDescription: '24/7 network monitoring and alerting',
                description: 'Continuous monitoring of network infrastructure with proactive alerting and issue resolution.',
                pricing: { type: 'fixed', amount: 99, currency: 'USD', period: 'monthly', displayText: '$99/month' },
                serviceLevel: { responseTime: '15 minutes', resolutionTime: '2 hours', availability: '24/7', emergencySupport: true },
                status: 'active',
                featured: true,
                tags: ['monitoring', 'network', 'proactive']
            },
            {
                id: '3',
                serviceName: 'Backup Service',
                category: 'Security',
                shortDescription: 'Automated backup and recovery solution',
                description: 'Comprehensive backup solution with automated daily backups and quick recovery options.',
                pricing: { type: 'fixed', amount: 75, currency: 'USD', period: 'monthly', displayText: '$75/month' },
                serviceLevel: { responseTime: '2 hours', resolutionTime: '4 hours', availability: '9 AM - 6 PM', emergencySupport: true },
                status: 'active',
                featured: false,
                tags: ['backup', 'security', 'recovery']
            }
        ];

        const initialClients = [
            {
                id: '1',
                companyName: 'Acme Corporation',
                contactName: 'John Smith',
                email: 'john.smith@acme.com',
                phone: '(555) 123-4567',
                address: '123 Business St, City, ST 12345',
                industry: 'Manufacturing',
                employees: 50,
                status: 'active',
                contractStart: '2024-01-15',
                contractEnd: '2024-12-31',
                monthlyValue: 2500,
                services: ['1', '2', '3'],
                notes: 'Primary contact prefers email communication. Monthly review meetings scheduled for first Tuesday of each month.'
            },
            {
                id: '2',
                companyName: 'Tech Innovations LLC',
                contactName: 'Sarah Johnson',
                email: 'sarah@techinnovations.com',
                phone: '(555) 987-6543',
                address: '456 Innovation Ave, Tech City, ST 54321',
                industry: 'Technology',
                employees: 25,
                status: 'active',
                contractStart: '2024-03-01',
                contractEnd: '2025-02-28',
                monthlyValue: 1800,
                services: ['1', '2'],
                notes: 'Fast-growing startup. Likely to need additional services as they scale.'
            },
            {
                id: '3',
                companyName: 'Downtown Medical',
                contactName: 'Dr. Michael Brown',
                email: 'mbrown@downtownmedical.com',
                phone: '(555) 456-7890',
                address: '789 Health Plaza, Medical District, ST 67890',
                industry: 'Healthcare',
                employees: 15,
                status: 'prospect',
                contractStart: null,
                contractEnd: null,
                monthlyValue: 0,
                services: [],
                notes: 'Interested in security and backup solutions. HIPAA compliance is critical.'
            }
        ];

        const categories = [
            'Apps & Software', 'Security', 'Monitoring', 'Hardware', 
            'Training', 'Phones & Tablets', 'Printing', 'Business Operations'
        ];

        const industries = [
            'Technology', 'Healthcare', 'Manufacturing', 'Finance', 'Retail', 
            'Education', 'Legal', 'Real Estate', 'Construction', 'Other'
        ];

        function App() {
            const [services, setServices] = useState(initialServices);
            const [clients, setClients] = useState(initialClients);
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedCategory, setSelectedCategory] = useState('all');
            const [activeTab, setActiveTab] = useState('dashboard');
            const [showExportModal, setShowExportModal] = useState(false);
            const [showClientModal, setShowClientModal] = useState(false);
            const [editingClient, setEditingClient] = useState(null);
            const [clientSearchTerm, setClientSearchTerm] = useState('');
            const [selectedIndustry, setSelectedIndustry] = useState('all');
            const [selectedStatus, setSelectedStatus] = useState('all');
            const [reportDateRange, setReportDateRange] = useState('30');
            const chartRef = useRef(null);
            const revenueChartRef = useRef(null);

            // Load data from localStorage on mount
            useEffect(() => {
                const savedServices = localStorage.getItem('msp-services');
                const savedClients = localStorage.getItem('msp-clients');
                if (savedServices) {
                    setServices(JSON.parse(savedServices));
                }
                if (savedClients) {
                    setClients(JSON.parse(savedClients));
                }
            }, []);

            // Save to localStorage whenever data changes
            useEffect(() => {
                localStorage.setItem('msp-services', JSON.stringify(services));
            }, [services]);

            useEffect(() => {
                localStorage.setItem('msp-clients', JSON.stringify(clients));
            }, [clients]);

            // Filter services
            const filteredServices = services.filter(service => {
                const matchesSearch = service.serviceName.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                     service.description.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesCategory = selectedCategory === 'all' || service.category === selectedCategory;
                return matchesSearch && matchesCategory;
            });

            // Filter clients
            const filteredClients = clients.filter(client => {
                const matchesSearch = client.companyName.toLowerCase().includes(clientSearchTerm.toLowerCase()) ||
                                     client.contactName.toLowerCase().includes(clientSearchTerm.toLowerCase());
                const matchesIndustry = selectedIndustry === 'all' || client.industry === selectedIndustry;
                const matchesStatus = selectedStatus === 'all' || client.status === selectedStatus;
                return matchesSearch && matchesIndustry && matchesStatus;
            });

            // Stats
            const stats = {
                totalServices: services.length,
                activeServices: services.filter(s => s.status === 'active').length,
                featuredServices: services.filter(s => s.featured).length,
                categories: [...new Set(services.map(s => s.category))].length,
                totalClients: clients.length,
                activeClients: clients.filter(c => c.status === 'active').length,
                prospects: clients.filter(c => c.status === 'prospect').length,
                monthlyRevenue: clients.filter(c => c.status === 'active').reduce((sum, c) => sum + c.monthlyValue, 0)
            };

            // Chart setup
            useEffect(() => {
                if (activeTab === 'reports' && chartRef.current) {
                    const ctx = chartRef.current.getContext('2d');
                    
                    // Destroy existing chart if it exists
                    if (window.servicesChart) {
                        window.servicesChart.destroy();
                    }
                    
                    const categoryData = categories.map(category => 
                        services.filter(s => s.category === category).length
                    );
                    
                    window.servicesChart = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: categories,
                            datasets: [{
                                data: categoryData,
                                backgroundColor: [
                                    '#3b82f6', '#10b981', '#f59e0b', '#ef4444',
                                    '#8b5cf6', '#06b6d4', '#84cc16', '#f97316'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
                
                if (activeTab === 'reports' && revenueChartRef.current) {
                    const ctx = revenueChartRef.current.getContext('2d');
                    
                    // Destroy existing chart if it exists
                    if (window.revenueChart) {
                        window.revenueChart.destroy();
                    }
                    
                    // Generate sample monthly revenue data
                    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
                    const revenueData = months.map(() => 
                        Math.floor(Math.random() * 5000) + 15000
                    );
                    
                    window.revenueChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: months,
                            datasets: [{
                                label: 'Monthly Revenue',
                                data: revenueData,
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        callback: function(value) {
                                            return '$' + value.toLocaleString();
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                }
            }, [activeTab, services]);

            // Client management functions
            const handleAddClient = () => {
                setEditingClient(null);
                setShowClientModal(true);
            };

            const handleEditClient = (client) => {
                setEditingClient(client);
                setShowClientModal(true);
            };

            const handleSaveClient = (clientData) => {
                if (editingClient) {
                    setClients(clients.map(c => c.id === editingClient.id ? { ...clientData, id: editingClient.id } : c));
                } else {
                    const newClient = { ...clientData, id: Date.now().toString() };
                    setClients([...clients, newClient]);
                }
                setShowClientModal(false);
                setEditingClient(null);
            };

            const handleDeleteClient = (clientId) => {
                if (confirm('Are you sure you want to delete this client?')) {
                    setClients(clients.filter(c => c.id !== clientId));
                }
            };

            // Export functions
            const handleExportCSV = () => {
                const csvData = services.map(service => ({
                    ServiceName: service.serviceName,
                    Category: service.category,
                    ShortDescription: service.shortDescription,
                    Description: service.description,
                    Pricing: service.pricing.displayText,
                    ResponseTime: service.serviceLevel.responseTime,
                    ResolutionTime: service.serviceLevel.resolutionTime,
                    Availability: service.serviceLevel.availability,
                    EmergencySupport: service.serviceLevel.emergencySupport,
                    Tags: service.tags.join(", ")
                }));
                
                const csv = Papa.unparse(csvData);
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'msp-service-catalog.csv';
                link.click();
                setShowExportModal(false);
            };

            const handleExportClientsCSV = () => {
                const csvData = clients.map(client => ({
                    CompanyName: client.companyName,
                    ContactName: client.contactName,
                    Email: client.email,
                    Phone: client.phone,
                    Industry: client.industry,
                    Employees: client.employees,
                    Status: client.status,
                    MonthlyValue: client.monthlyValue,
                    ContractStart: client.contractStart,
                    ContractEnd: client.contractEnd,
                    Services: client.services.map(sId => services.find(s => s.id === sId)?.serviceName).filter(Boolean).join(", ")
                }));
                
                const csv = Papa.unparse(csvData);
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'msp-clients.csv';
                link.click();
            };

            return (
                <div>
                    {/* Header */}
                    <div className="header">
                        <div className="container">
                            <div className="header-content">
                                <h1>MSP Service Catalog</h1>
                                <button className="btn" onClick={() => setShowExportModal(true)}>
                                    📤 Export
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="container">
                        {/* Tabs */}
                        <div className="tabs">
                            <button 
                                className={`tab ${activeTab === 'dashboard' ? 'active' : ''}`}
                                onClick={() => setActiveTab('dashboard')}
                            >
                                Dashboard
                            </button>
                            <button 
                                className={`tab ${activeTab === 'services' ? 'active' : ''}`}
                                onClick={() => setActiveTab('services')}
                            >
                                Services
                            </button>
                            <button 
                                className={`tab ${activeTab === 'clients' ? 'active' : ''}`}
                                onClick={() => setActiveTab('clients')}
                            >
                                Clients
                            </button>
                            <button 
                                className={`tab ${activeTab === 'reports' ? 'active' : ''}`}
                                onClick={() => setActiveTab('reports')}
                            >
                                Reports
                            </button>
                        </div>

                        {/* Dashboard Tab */}
                        {activeTab === 'dashboard' && (
                            <div>
                                <div className="stats-grid">
                                    <div className="stat-card">
                                        <h3>Total Services</h3>
                                        <div className="value">{stats.totalServices}</div>
                                    </div>
                                    <div className="stat-card">
                                        <h3>Active Services</h3>
                                        <div className="value">{stats.activeServices}</div>
                                    </div>
                                    <div className="stat-card">
                                        <h3>Total Clients</h3>
                                        <div className="value">{stats.totalClients}</div>
                                    </div>
                                    <div className="stat-card">
                                        <h3>Monthly Revenue</h3>
                                        <div className="value">${stats.monthlyRevenue.toLocaleString()}</div>
                                    </div>
                                </div>

                                <div className="two-column">
                                    <div className="service-card">
                                        <h3 style={{marginBottom: '1rem'}}>Quick Actions</h3>
                                        <div style={{display: 'flex', gap: '1rem', flexWrap: 'wrap'}}>
                                            <button className="btn btn-primary">➕ Add New Service</button>
                                            <button className="btn btn-success" onClick={handleAddClient}>👥 Add New Client</button>
                                            <button className="btn" onClick={() => setActiveTab('reports')}>📊 View Reports</button>
                                            <button className="btn" onClick={() => setShowExportModal(true)}>📤 Export Data</button>
                                        </div>
                                    </div>
                                    
                                    <div className="service-card">
                                        <h3 style={{marginBottom: '1rem'}}>Recent Activity</h3>
                                        <div style={{fontSize: '0.875rem', color: '#6b7280'}}>
                                            <div style={{marginBottom: '0.5rem'}}>• Office 365 Setup service updated</div>
                                            <div style={{marginBottom: '0.5rem'}}>• New client "Tech Innovations LLC" added</div>
                                            <div style={{marginBottom: '0.5rem'}}>• Backup Service pricing modified</div>
                                            <div>• Monthly report generated</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Services Tab */}
                        {activeTab === 'services' && (
                            <div>
                                <div className="search-controls">
                                    <input
                                        type="text"
                                        placeholder="Search services..."
                                        className="search-input"
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                    <select 
                                        className="select"
                                        value={selectedCategory}
                                        onChange={(e) => setSelectedCategory(e.target.value)}
                                    >
                                        <option value="all">All Categories</option>
                                        {categories.map(category => (
                                            <option key={category} value={category}>{category}</option>
                                        ))}
                                    </select>
                                    <button className="btn btn-primary">➕ Add Service</button>
                                </div>

                                <div className="services-grid">
                                    {filteredServices.map(service => (
                                        <div key={service.id} className="service-card">
                                            <div className="service-header">
                                                <div>
                                                    <div className="service-title">{service.serviceName}</div>
                                                    <div className="service-description">{service.shortDescription}</div>
                                                </div>
                                                <span className={`badge ${service.status === 'active' ? 'badge-success' : 'badge-secondary'}`}>
                                                    {service.status}
                                                </span>
                                            </div>
                                            
                                            <div className="service-details">
                                                <div className="service-detail">
                                                    <span className="label">Category:</span>
                                                    <span className="badge badge-secondary">{service.category}</span>
                                                </div>
                                                <div className="service-detail">
                                                    <span className="label">Price:</span>
                                                    <span className="value">{service.pricing.displayText}</span>
                                                </div>
                                                <div className="service-detail">
                                                    <span className="label">Response:</span>
                                                    <span className="value">{service.serviceLevel.responseTime}</span>
                                                </div>
                                            </div>

                                            <div className="tags">
                                                {service.tags.map(tag => (
                                                    <span key={tag} className="badge badge-secondary">{tag}</span>
                                                ))}
                                            </div>

                                            <div className="service-actions">
                                                <button className="btn btn-sm">✏️ Edit</button>
                                                <button className="btn btn-sm">📋 Copy</button>
                                                <button className="btn btn-sm btn-danger">🗑️ Delete</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Clients Tab */}
                        {activeTab === 'clients' && (
                            <div>
                                <div className="search-controls">
                                    <input
                                        type="text"
                                        placeholder="Search clients..."
                                        className="search-input"
                                        value={clientSearchTerm}
                                        onChange={(e) => setClientSearchTerm(e.target.value)}
                                    />
                                    <select 
                                        className="select"
                                        value={selectedIndustry}
                                        onChange={(e) => setSelectedIndustry(e.target.value)}
                                    >
                                        <option value="all">All Industries</option>
                                        {industries.map(industry => (
                                            <option key={industry} value={industry}>{industry}</option>
                                        ))}
                                    </select>
                                    <select 
                                        className="select"
                                        value={selectedStatus}
                                        onChange={(e) => setSelectedStatus(e.target.value)}
                                    >
                                        <option value="all">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="prospect">Prospect</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                    <button className="btn btn-primary" onClick={handleAddClient}>➕ Add Client</button>
                                    <button className="btn" onClick={handleExportClientsCSV}>📤 Export CSV</button>
                                </div>

                                <div>
                                    {filteredClients.map(client => (
                                        <div key={client.id} className="client-card">
                                            <div className="client-header">
                                                <div>
                                                    <div className="client-name">{client.companyName}</div>
                                                    <div style={{color: '#6b7280', fontSize: '0.875rem'}}>{client.contactName}</div>
                                                </div>
                                                <div style={{display: 'flex', gap: '0.5rem', alignItems: 'center'}}>
                                                    <span className={`badge ${
                                                        client.status === 'active' ? 'badge-success' : 
                                                        client.status === 'prospect' ? 'badge-warning' : 'badge-secondary'
                                                    }`}>
                                                        {client.status}
                                                    </span>
                                                    <button className="btn btn-sm" onClick={() => handleEditClient(client)}>✏️ Edit</button>
                                                    <button className="btn btn-sm btn-danger" onClick={() => handleDeleteClient(client.id)}>🗑️</button>
                                                </div>
                                            </div>
                                            
                                            <div className="client-info">
                                                <div className="info-item">
                                                    <div className="info-label">Email</div>
                                                    <div className="info-value">{client.email}</div>
                                                </div>
                                                <div className="info-item">
                                                    <div className="info-label">Phone</div>
                                                    <div className="info-value">{client.phone}</div>
                                                </div>
                                                <div className="info-item">
                                                    <div className="info-label">Industry</div>
                                                    <div className="info-value">{client.industry}</div>
                                                </div>
                                                <div className="info-item">
                                                    <div className="info-label">Employees</div>
                                                    <div className="info-value">{client.employees}</div>
                                                </div>
                                                <div className="info-item">
                                                    <div className="info-label">Monthly Value</div>
                                                    <div className="info-value">${client.monthlyValue.toLocaleString()}</div>
                                                </div>
                                                <div className="info-item">
                                                    <div className="info-label">Services</div>
                                                    <div className="info-value">
                                                        {client.services.map(serviceId => {
                                                            const service = services.find(s => s.id === serviceId);
                                                            return service ? (
                                                                <span key={serviceId} className="badge badge-primary" style={{marginRight: '0.25rem'}}>
                                                                    {service.serviceName}
                                                                </span>
                                                            ) : null;
                                                        })}
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            {client.notes && (
                                                <div style={{marginTop: '1rem', padding: '1rem', background: '#f8fafc', borderRadius: '0.375rem'}}>
                                                    <div className="info-label">Notes</div>
                                                    <div style={{fontSize: '0.875rem'}}>{client.notes}</div>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Reports Tab */}
                        {activeTab === 'reports' && (
                            <div>
                                <div className="report-filters">
                                    <h3 style={{marginBottom: '1rem'}}>Report Filters</h3>
                                    <div className="filter-row">
                                        <div className="form-group">
                                            <label>Date Range</label>
                                            <select 
                                                className="select"
                                                value={reportDateRange}
                                                onChange={(e) => setReportDateRange(e.target.value)}
                                            >
                                                <option value="7">Last 7 days</option>
                                                <option value="30">Last 30 days</option>
                                                <option value="90">Last 90 days</option>
                                                <option value="365">Last year</option>
                                            </select>
                                        </div>
                                        <button className="btn btn-primary">Generate Report</button>
                                        <button className="btn">📤 Export PDF</button>
                                    </div>
                                </div>

                                <div className="stats-grid">
                                    <div className="stat-card">
                                        <h3>Active Clients</h3>
                                        <div className="value">{stats.activeClients}</div>
                                    </div>
                                    <div className="stat-card">
                                        <h3>Prospects</h3>
                                        <div className="value">{stats.prospects}</div>
                                    </div>
                                    <div className="stat-card">
                                        <h3>Monthly Revenue</h3>
                                        <div className="value">${stats.monthlyRevenue.toLocaleString()}</div>
                                    </div>
                                    <div className="stat-card">
                                        <h3>Avg. Client Value</h3>
                                        <div className="value">
                                            ${stats.activeClients > 0 ? Math.round(stats.monthlyRevenue / stats.activeClients).toLocaleString() : 0}
                                        </div>
                                    </div>
                                </div>

                                <div className="two-column">
                                    <div className="chart-container">
                                        <div className="chart-title">Services by Category</div>
                                        <div style={{height: '300px', position: 'relative'}}>
                                            <canvas ref={chartRef}></canvas>
                                        </div>
                                    </div>
                                    
                                    <div className="chart-container">
                                        <div className="chart-title">Revenue Trend</div>
                                        <div style={{height: '300px', position: 'relative'}}>
                                            <canvas ref={revenueChartRef}></canvas>
                                        </div>
                                    </div>
                                </div>

                                <div className="chart-container">
                                    <div className="chart-title">Client Summary</div>
                                    <table className="table">
                                        <thead>
                                            <tr>
                                                <th>Company</th>
                                                <th>Industry</th>
                                                <th>Status</th>
                                                <th>Monthly Value</th>
                                                <th>Services</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {clients.slice(0, 10).map(client => (
                                                <tr key={client.id}>
                                                    <td>{client.companyName}</td>
                                                    <td>{client.industry}</td>
                                                    <td>
                                                        <span className={`badge ${
                                                            client.status === 'active' ? 'badge-success' : 
                                                            client.status === 'prospect' ? 'badge-warning' : 'badge-secondary'
                                                        }`}>
                                                            {client.status}
                                                        </span>
                                                    </td>
                                                    <td>${client.monthlyValue.toLocaleString()}</td>
                                                    <td>{client.services.length}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Export Modal */}
                    {showExportModal && (
                        <div className="modal" onClick={() => setShowExportModal(false)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <h2>Export Data</h2>
                                <p style={{marginBottom: '2rem', color: '#6b7280'}}>
                                    Select what you'd like to export.
                                </p>
                                <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
                                    <button className="btn btn-primary" onClick={handleExportCSV}>
                                        📋 Export Services as CSV
                                    </button>
                                    <button className="btn btn-primary" onClick={handleExportClientsCSV}>
                                        👥 Export Clients as CSV
                                    </button>
                                    <button className="btn" onClick={() => setShowExportModal(false)}>
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Client Modal */}
                    {showClientModal && (
                        <ClientModal
                            client={editingClient}
                            services={services}
                            industries={industries}
                            onSave={handleSaveClient}
                            onClose={() => {
                                setShowClientModal(false);
                                setEditingClient(null);
                            }}
                        />
                    )}
                </div>
            );
        }

        // Client Modal Component
        function ClientModal({ client, services, industries, onSave, onClose }) {
            const [formData, setFormData] = useState({
                companyName: client?.companyName || '',
                contactName: client?.contactName || '',
                email: client?.email || '',
                phone: client?.phone || '',
                address: client?.address || '',
                industry: client?.industry || industries[0],
                employees: client?.employees || '',
                status: client?.status || 'prospect',
                contractStart: client?.contractStart || '',
                contractEnd: client?.contractEnd || '',
                monthlyValue: client?.monthlyValue || 0,
                services: client?.services || [],
                notes: client?.notes || ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({
                    ...formData,
                    employees: parseInt(formData.employees) || 0,
                    monthlyValue: parseFloat(formData.monthlyValue) || 0
                });
            };

            const handleServiceToggle = (serviceId) => {
                const newServices = formData.services.includes(serviceId)
                    ? formData.services.filter(id => id !== serviceId)
                    : [...formData.services, serviceId];
                setFormData({ ...formData, services: newServices });
            };

            return (
                <div className="modal" onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                        <h2>{client ? 'Edit Client' : 'Add New Client'}</h2>
                        <form onSubmit={handleSubmit}>
                            <div className="two-column">
                                <div className="form-group">
                                    <label>Company Name *</label>
                                    <input
                                        type="text"
                                        required
                                        value={formData.companyName}
                                        onChange={(e) => setFormData({ ...formData, companyName: e.target.value })}
                                    />
                                </div>
                                <div className="form-group">
                                    <label>Contact Name *</label>
                                    <input
                                        type="text"
                                        required
                                        value={formData.contactName}
                                        onChange={(e) => setFormData({ ...formData, contactName: e.target.value })}
                                    />
                                </div>
                            </div>

                            <div className="two-column">
                                <div className="form-group">
                                    <label>Email *</label>
                                    <input
                                        type="email"
                                        required
                                        value={formData.email}
                                        onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                                    />
                                </div>
                                <div className="form-group">
                                    <label>Phone</label>
                                    <input
                                        type="tel"
                                        value={formData.phone}
                                        onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                                    />
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Address</label>
                                <textarea
                                    value={formData.address}
                                    onChange={(e) => setFormData({ ...formData, address: e.target.value })}
                                />
                            </div>

                            <div className="two-column">
                                <div className="form-group">
                                    <label>Industry</label>
                                    <select
                                        value={formData.industry}
                                        onChange={(e) => setFormData({ ...formData, industry: e.target.value })}
                                    >
                                        {industries.map(industry => (
                                            <option key={industry} value={industry}>{industry}</option>
                                        ))}
                                    </select>
                                </div>
                                <div className="form-group">
                                    <label>Employees</label>
                                    <input
                                        type="number"
                                        min="1"
                                        value={formData.employees}
                                        onChange={(e) => setFormData({ ...formData, employees: e.target.value })}
                                    />
                                </div>
                            </div>

                            <div className="two-column">
                                <div className="form-group">
                                    <label>Status</label>
                                    <select
                                        value={formData.status}
                                        onChange={(e) => setFormData({ ...formData, status: e.target.value })}
                                    >
                                        <option value="prospect">Prospect</option>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                                <div className="form-group">
                                    <label>Monthly Value ($)</label>
                                    <input
                                        type="number"
                                        min="0"
                                        step="0.01"
                                        value={formData.monthlyValue}
                                        onChange={(e) => setFormData({ ...formData, monthlyValue: e.target.value })}
                                    />
                                </div>
                            </div>

                            <div className="two-column">
                                <div className="form-group">
                                    <label>Contract Start</label>
                                    <input
                                        type="date"
                                        value={formData.contractStart}
                                        onChange={(e) => setFormData({ ...formData, contractStart: e.target.value })}
                                    />
                                </div>
                                <div className="form-group">
                                    <label>Contract End</label>
                                    <input
                                        type="date"
                                        value={formData.contractEnd}
                                        onChange={(e) => setFormData({ ...formData, contractEnd: e.target.value })}
                                    />
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Services</label>
                                <div style={{display: 'flex', flexWrap: 'wrap', gap: '0.5rem', marginTop: '0.5rem'}}>
                                    {services.map(service => (
                                        <label key={service.id} style={{display: 'flex', alignItems: 'center', gap: '0.25rem', cursor: 'pointer'}}>
                                            <input
                                                type="checkbox"
                                                checked={formData.services.includes(service.id)}
                                                onChange={() => handleServiceToggle(service.id)}
                                            />
                                            <span className="badge badge-secondary">{service.serviceName}</span>
                                        </label>
                                    ))}
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Notes</label>
                                <textarea
                                    value={formData.notes}
                                    onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
                                    placeholder="Additional notes about this client..."
                                />
                            </div>

                            <div className="form-actions">
                                <button type="button" className="btn" onClick={onClose}>Cancel</button>
                                <button type="submit" className="btn btn-primary">
                                    {client ? 'Update Client' : 'Add Client'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>

